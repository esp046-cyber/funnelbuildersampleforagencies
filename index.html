<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FunnelForge AI 2026</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, sans-serif; background: #0F172A; color: white; padding: 10px 10px 90px 10px; }
        .header { background: linear-gradient(135deg, #6366F1, #8B5CF6); padding: 16px; border-radius: 12px; margin-bottom: 10px; }
        .header h1 { font-size: 1.1rem; margin-bottom: 4px; }
        .header p { font-size: 0.75rem; }
        .stats { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 10px; }
        .stat { background: #1E293B; padding: 12px; border-radius: 10px; border: 1px solid #6366F144; }
        .stat-label { font-size: 0.7rem; color: #64748B; }
        .stat-value { font-size: 1.3rem; font-weight: 700; margin-top: 4px; }
        .section { font-size: 0.85rem; font-weight: 700; margin: 15px 0 10px 0; }
        .tools { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 10px; }
        .tool { background: #1E293B; border: 1px solid #6366F144; padding: 15px 10px; border-radius: 10px; text-align: center; cursor: pointer; transition: 0.15s; }
        .tool:active { transform: scale(0.9); background: linear-gradient(135deg, #6366F1, #8B5CF6); }
        .tool-icon { font-size: 1.5rem; margin-bottom: 6px; }
        .tool-name { font-size: 0.65rem; font-weight: 600; }
        .funnels { display: flex; flex-direction: column; gap: 10px; margin-bottom: 10px; }
        .funnel { background: #1E293B; border: 1px solid #6366F144; border-radius: 10px; padding: 12px; display: flex; gap: 12px; align-items: center; }
        .funnel-icon { width: 60px; height: 60px; background: linear-gradient(135deg, #6366F1, #EC4899); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; flex-shrink: 0; }
        .funnel-info { flex: 1; }
        .funnel-name { font-size: 0.8rem; font-weight: 700; margin-bottom: 4px; }
        .funnel-meta { font-size: 0.65rem; color: #64748B; }
        .funnel-delete { background: #EF4444; color: white; border: none; padding: 10px 16px; border-radius: 6px; font-size: 0.75rem; cursor: pointer; font-weight: 700; }
        .funnel-delete:active { transform: scale(0.9); background: #DC2626; }
        .actions { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .btn { padding: 16px 12px; border-radius: 10px; font-weight: 700; font-size: 0.75rem; cursor: pointer; border: none; display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.15s; color: white; }
        .btn-primary { background: linear-gradient(135deg, #6366F1, #4F46E5); box-shadow: 0 4px 12px #6366F144; }
        .btn-secondary { background: #1E293B; border: 1px solid #6366F144; }
        .btn:active { transform: scale(0.94); }
        .nav { position: fixed; bottom: 0; left: 0; right: 0; background: #1E293B; border-top: 1px solid #6366F144; display: flex; padding: 8px; }
        .nav-item { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 4px; padding: 10px; cursor: pointer; border-radius: 8px; transition: 0.15s; }
        .nav-item:active { transform: scale(0.92); }
        .nav-item.active { background: #6366F133; }
        .nav-icon { font-size: 1.2rem; color: #64748B; }
        .nav-item.active .nav-icon { color: #6366F1; }
        .nav-label { font-size: 0.6rem; color: #64748B; font-weight: 600; }
        .nav-item.active .nav-label { color: #6366F1; }
        .toast { position: fixed; top: 80px; left: 50%; transform: translateX(-50%) translateY(-120px); background: linear-gradient(135deg, #6366F1, #8B5CF6); padding: 14px 24px; border-radius: 24px; font-size: 0.85rem; font-weight: 600; box-shadow: 0 8px 24px #0008; z-index: 10000; transition: 0.3s; }
        .toast.show { transform: translateX(-50%) translateY(0); }
        .modal { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: #000c; display: none; align-items: center; justify-content: center; z-index: 9999; padding: 20px; }
        .modal.show { display: flex; }
        .modal-box { background: #1E293B; border-radius: 16px; padding: 24px; width: 100%; max-width: 400px; border: 1px solid #6366F144; }
        .modal-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 20px; }
        .form-group { margin-bottom: 16px; }
        .form-label { display: block; font-size: 0.75rem; color: #64748B; margin-bottom: 6px; font-weight: 600; }
        .form-input, .form-select { width: 100%; background: #0F172A; border: 1px solid #6366F144; border-radius: 8px; padding: 12px; color: white; font-size: 0.85rem; }
        .form-input:focus, .form-select:focus { outline: none; border-color: #6366F1; }
        .modal-btns { display: flex; gap: 10px; margin-top: 20px; }
        #content { margin-top: 10px; }
        .report { background: #1E293B; border: 1px solid #6366F144; border-radius: 10px; padding: 16px; margin-bottom: 10px; }
        .report-title { font-size: 0.9rem; font-weight: 700; margin-bottom: 8px; }
        .report-text { font-size: 0.75rem; color: #64748B; line-height: 1.6; }
        .templates { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .template { background: #1E293B; border: 1px solid #6366F144; border-radius: 10px; padding: 16px; text-align: center; cursor: pointer; transition: 0.15s; }
        .template:active { transform: scale(0.95); background: #6366F122; }
        .template-icon { font-size: 2rem; margin-bottom: 8px; }
        .template-name { font-size: 0.75rem; font-weight: 600; }
        .debug { position: fixed; bottom: 80px; left: 10px; background: #000; color: lime; padding: 10px; font-size: 0.7rem; border-radius: 8px; max-width: 90%; font-family: monospace; }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸš€ FunnelForge AI</h1>
        <p>Agency Funnel Builder 2026</p>
    </div>

    <div class="stats">
        <div class="stat">
            <div class="stat-label">Active Funnels</div>
            <div class="stat-value"><span id="statFunnels">4</span></div>
        </div>
        <div class="stat">
            <div class="stat-label">Conversions</div>
            <div class="stat-value">89%</div>
        </div>
        <div class="stat">
            <div class="stat-label">Automations</div>
            <div class="stat-value"><span id="statAuto">0</span></div>
        </div>
        <div class="stat">
            <div class="stat-label">Revenue</div>
            <div class="stat-value">$48K</div>
        </div>
    </div>

    <div class="section">âš¡ AI Tools</div>
    <div class="tools">
        <div class="tool"><div class="tool-icon">âœï¸</div><div class="tool-name">AI Writer</div></div>
        <div class="tool"><div class="tool-icon">ğŸ¨</div><div class="tool-name">Design</div></div>
        <div class="tool"><div class="tool-icon">ğŸ“Š</div><div class="tool-name">Analytics</div></div>
        <div class="tool"><div class="tool-icon">ğŸ”</div><div class="tool-name">SEO</div></div>
        <div class="tool"><div class="tool-icon">ğŸ“§</div><div class="tool-name">Email</div></div>
        <div class="tool"><div class="tool-icon">ğŸ’¬</div><div class="tool-name">Chatbot</div></div>
    </div>

    <div class="section">ğŸ¯ Funnels (<span id="count">4</span>)</div>
    <div class="funnels" id="funnelList"></div>

    <div class="section">âš¡ Actions</div>
    <div class="actions">
        <button class="btn btn-primary" id="btnCreate">â• Create Funnel</button>
        <button class="btn btn-secondary" id="btnTemplates">ğŸ“‹ Templates</button>
        <button class="btn btn-secondary" id="btnAuto">ğŸ¤– Automation</button>
        <button class="btn btn-secondary" id="btnReports">ğŸ“ˆ Reports</button>
    </div>

    <div id="content"></div>

    <div class="nav">
        <div class="nav-item active" data-tab="home">
            <div class="nav-icon">ğŸ </div>
            <div class="nav-label">Home</div>
        </div>
        <div class="nav-item" data-tab="funnels">
            <div class="nav-icon">ğŸ¯</div>
            <div class="nav-label">Funnels</div>
        </div>
        <div class="nav-item" data-tab="ai">
            <div class="nav-icon">ğŸ¤–</div>
            <div class="nav-label">AI</div>
        </div>
        <div class="nav-item" data-tab="stats">
            <div class="nav-icon">ğŸ“Š</div>
            <div class="nav-label">Stats</div>
        </div>
        <div class="nav-item" data-tab="profile">
            <div class="nav-icon">ğŸ‘¤</div>
            <div class="nav-label">Profile</div>
        </div>
    </div>

    <div class="toast" id="toast"></div>
    <div class="debug" id="debug">DEBUG: App loaded</div>

    <div class="modal" id="modal">
        <div class="modal-box">
            <div class="modal-title">â• Create New Funnel</div>
            <div class="form-group">
                <label class="form-label">Funnel Name</label>
                <input type="text" class="form-input" id="name" placeholder="My Awesome Funnel">
            </div>
            <div class="form-group">
                <label class="form-label">Type</label>
                <select class="form-select" id="type">
                    <option value="lead">Lead Generation</option>
                    <option value="sales">Sales Page</option>
                    <option value="webinar">Webinar</option>
                    <option value="ecom">E-commerce</option>
                </select>
            </div>
            <div class="modal-btns">
                <button class="btn btn-secondary" id="btnCancel" style="flex:1">Cancel</button>
                <button class="btn btn-primary" id="btnAdd" style="flex:1">Create</button>
            </div>
        </div>
    </div>

    <script>
        // GLOBAL STATE
        let funnels = [
            {id:1, name:'Lead Magnet Pro', type:'lead', icon:'ğŸ“±', visitors:2400},
            {id:2, name:'Sales Page Elite', type:'sales', icon:'ğŸ’°', visitors:1800},
            {id:3, name:'Webinar Funnel', type:'webinar', icon:'ğŸ¥', visitors:890},
            {id:4, name:'Agency Portfolio', type:'agency', icon:'ğŸ¢', visitors:3200}
        ];
        let autoCount = 0;

        // DEBUG LOGGER
        function debug(msg) {
            console.log(msg);
            const d = document.getElementById('debug');
            d.textContent = 'DEBUG: ' + msg;
        }

        // RENDER FUNNELS
        function render() {
            debug(`Rendering ${funnels.length} funnels...`);
            
            const list = document.getElementById('funnelList');
            list.innerHTML = '';
            
            funnels.forEach((f, index) => {
                const div = document.createElement('div');
                div.className = 'funnel';
                div.innerHTML = `
                    <div class="funnel-icon">${f.icon}</div>
                    <div class="funnel-info">
                        <div class="funnel-name">${f.name}</div>
                        <div class="funnel-meta">${(f.visitors/1000).toFixed(1)}K visitors â€¢ ID: ${f.id}</div>
                    </div>
                    <button class="funnel-delete" data-id="${f.id}">DELETE</button>
                `;
                list.appendChild(div);
                
                // ATTACH DELETE HANDLER IMMEDIATELY
                const deleteBtn = div.querySelector('.funnel-delete');
                deleteBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    const deleteId = parseInt(this.getAttribute('data-id'));
                    debug(`Delete clicked for ID: ${deleteId}`);
                    
                    const funnelToDelete = funnels.find(fn => fn.id === deleteId);
                    debug(`Found funnel: ${funnelToDelete.name}`);
                    
                    if(confirm(`âŒ DELETE "${funnelToDelete.name}"?\n\nThis cannot be undone!`)) {
                        debug(`User confirmed delete for ID ${deleteId}`);
                        
                        const beforeLength = funnels.length;
                        funnels = funnels.filter(fn => fn.id !== deleteId);
                        const afterLength = funnels.length;
                        
                        debug(`Deleted! Before: ${beforeLength}, After: ${afterLength}`);
                        
                        render();
                        toast(`ğŸ—‘ï¸ "${funnelToDelete.name}" DELETED!`);
                    } else {
                        debug('Delete cancelled by user');
                    }
                });
            });
            
            document.getElementById('count').textContent = funnels.length;
            document.getElementById('statFunnels').textContent = funnels.length;
            
            debug(`Render complete. Total funnels: ${funnels.length}`);
        }

        // TOAST
        function toast(msg) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 2500);
        }

        // CREATE BUTTON
        document.getElementById('btnCreate').addEventListener('click', function() {
            debug('Create button clicked');
            document.getElementById('modal').classList.add('show');
        });

        // CANCEL BUTTON
        document.getElementById('btnCancel').addEventListener('click', function() {
            debug('Cancel button clicked');
            document.getElementById('modal').classList.remove('show');
        });

        // ADD BUTTON
        document.getElementById('btnAdd').addEventListener('click', function() {
            const name = document.getElementById('name').value.trim();
            const type = document.getElementById('type').value;
            
            debug(`Add clicked: name="${name}", type="${type}"`);
            
            if(!name) { 
                toast('âŒ Enter a funnel name!'); 
                return; 
            }
            
            const icons = {lead:'ğŸ“±', sales:'ğŸ’°', webinar:'ğŸ¥', ecom:'ğŸ›’'};
            const newFunnel = {
                id: Date.now(),
                name: name,
                type: type,
                icon: icons[type],
                visitors: 0
            };
            
            funnels.push(newFunnel);
            debug(`Added funnel ID ${newFunnel.id}. Total: ${funnels.length}`);
            
            render();
            document.getElementById('modal').classList.remove('show');
            document.getElementById('name').value = '';
            toast(`âœ… "${name}" created!`);
        });

        // TEMPLATES
        document.getElementById('btnTemplates').addEventListener('click', function() {
            debug('Templates button clicked');
            document.getElementById('content').innerHTML = `
                <div class="section">ğŸ“‹ Templates</div>
                <div class="templates" id="templateGrid"></div>
            `;
            
            const templates = [
                {name:'Lead Capture', type:'lead', icon:'ğŸ“±'},
                {name:'Sales Funnel', type:'sales', icon:'ğŸ’°'},
                {name:'Webinar Pro', type:'webinar', icon:'ğŸ¥'},
                {name:'Shop Now', type:'ecom', icon:'ğŸ›’'}
            ];
            
            const grid = document.getElementById('templateGrid');
            templates.forEach(t => {
                const div = document.createElement('div');
                div.className = 'template';
                div.innerHTML = `
                    <div class="template-icon">${t.icon}</div>
                    <div class="template-name">${t.name}</div>
                `;
                div.addEventListener('click', function() {
                    debug(`Template "${t.name}" clicked`);
                    funnels.push({id: Date.now(), name: t.name, type: t.type, icon: t.icon, visitors: 0});
                    render();
                    document.getElementById('content').innerHTML = '';
                    toast(`âœ… "${t.name}" added!`);
                });
                grid.appendChild(div);
            });
            
            toast('ğŸ“‹ Templates loaded');
        });

        // AUTOMATION
        document.getElementById('btnAuto').addEventListener('click', function() {
            autoCount++;
            debug(`Automation #${autoCount} started`);
            document.getElementById('statAuto').textContent = autoCount;
            document.getElementById('content').innerHTML = `
                <div class="section">ğŸ¤– Automation #${autoCount} Running</div>
                <div class="report">
                    <div class="report-title">Email Campaign</div>
                    <div class="report-text">âœ… Sending to 1,247 leads<br>âœ… A/B testing 3 subject lines<br>âœ… AI optimizing send times</div>
                </div>
                <div class="report">
                    <div class="report-title">Lead Scoring</div>
                    <div class="report-text">âœ… Analyzing 3,482 behaviors<br>âœ… 127 hot leads found<br>âœ… Auto-assigned to sales</div>
                </div>
            `;
            toast(`ğŸ¤– Automation #${autoCount} started!`);
        });

        // REPORTS
        document.getElementById('btnReports').addEventListener('click', function() {
            debug('Reports button clicked');
            const total = funnels.reduce((s,f) => s + f.visitors, 0);
            document.getElementById('content').innerHTML = `
                <div class="section">ğŸ“ˆ Analytics Report</div>
                <div class="report">
                    <div class="report-title">Overview</div>
                    <div class="report-text">ğŸ“Š Total: ${total.toLocaleString()} visitors<br>ğŸ“ˆ Conversion: 87.3%<br>ğŸ’° Revenue: $${(total*0.05).toFixed(0)}</div>
                </div>
                <div class="report">
                    <div class="report-title">Top Funnel</div>
                    <div class="report-text">ğŸ† ${funnels[0]?.name || 'None'}<br>ğŸ‘¥ ${funnels[0]?.visitors.toLocaleString() || 0} visitors<br>â­ 4.8 rating</div>
                </div>
                <div class="report">
                    <div class="report-title">AI Tips</div>
                    <div class="report-text">ğŸ’¡ Add exit popup to boost 15%<br>ğŸ’¡ Test green CTA button<br>ğŸ’¡ Increase email frequency</div>
                </div>
            `;
            toast('ğŸ“ˆ Report generated!');
        });

        // NAVIGATION
        document.querySelectorAll('.nav-item').forEach(item => {
            item.addEventListener('click', function() {
                const tab = this.getAttribute('data-tab');
                debug(`Nav: ${tab} clicked`);
                
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                
                if(tab === 'home') {
                    document.getElementById('content').innerHTML = '';
                    toast('ğŸ  Home');
                } else if(tab === 'funnels') {
                    document.getElementById('content').innerHTML = `
                        <div class="section">ğŸ¯ All Your Funnels</div>
                        <div class="report">
                            <div class="report-title">Funnels Overview</div>
                            <div class="report-text">You have ${funnels.length} active funnels. Keep building!</div>
                        </div>
                    `;
                    toast('ğŸ¯ Funnels');
                } else if(tab === 'ai') {
                    document.getElementById('content').innerHTML = `
                        <div class="section">ğŸ¤– AI Tools Dashboard</div>
                        <div class="report">
                            <div class="report-title">AI Features</div>
                            <div class="report-text">âœ… AI Writer<br>âœ… Design AI<br>âœ… SEO Bot<br>âœ… Email AI</div>
                        </div>
                    `;
                    toast('ğŸ¤– AI Tools');
                } else if(tab === 'stats') {
                    const total = funnels.reduce((s,f) => s + f.visitors, 0);
                    document.getElementById('content').innerHTML = `
                        <div class="section">ğŸ“Š Statistics</div>
                        <div class="report">
                            <div class="report-title">Performance</div>
                            <div class="report-text">ğŸ“Š Visitors: ${total.toLocaleString()}<br>ğŸ“ˆ Conversion: 89%<br>ğŸ’° Revenue: $48K<br>ğŸ¤– Automations: ${autoCount}</div>
                        </div>
                    `;
                    toast('ğŸ“Š Statistics');
                } else if(tab === 'profile') {
                    document.getElementById('content').innerHTML = `
                        <div class="section">ğŸ‘¤ Profile</div>
                        <div class="report">
                            <div class="report-title">Account</div>
                            <div class="report-text">ğŸ‘¤ Agency Owner<br>ğŸ“§ owner@agency.com<br>ğŸ“… Since 2026<br>â­ Pro Plan</div>
                        </div>
                    `;
                    toast('ğŸ‘¤ Profile');
                }
            });
        });

        // INITIALIZE
        debug('Initializing app...');
        render();
        setTimeout(() => {
            toast('ğŸ‘‹ Welcome to FunnelForge AI!');
            debug('App ready. Watch this box for debug info!');
        }, 500);
    </script>
</body>
</html>
